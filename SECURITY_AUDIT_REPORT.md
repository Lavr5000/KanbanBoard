# üîí –û—Ç—á–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2026-01-04
**–ü—Ä–æ–µ–∫—Ç:** Kanban Board 2.0
**–í–µ—Ä—Å–∏—è:** 2.0.0
**–ê—É–¥–∏—Ç–æ—Ä:** Claude Code Security Audit

---

## ‚õî –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ù–ï–ú–ï–î–õ–ï–ù–ù–û)

### 1. üö® –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π –≤ –ø—É–±–ª–∏—á–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

**–£—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `wrangler.toml:15-18`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```toml
[vars]
DEEPSEEK_API_KEY = "sk-5b24ee34458047a09ee8936c930bf625"
NEXT_PUBLIC_SUPABASE_URL = "https://ygxnblhpjdhqjgcmcxgu.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
SUPABASE_SERVICE_ROLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- ‚ö†Ô∏è **DEEPSEEK_API_KEY** - –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à API –∫–ª—é—á, –Ω–∞–∫—Ä—É—Ç–∏–≤ –æ–≥—Ä–æ–º–Ω—ã–µ —Å—á–µ—Ç–∞
- ‚ö†Ô∏è **SUPABASE_SERVICE_ROLE_KEY** - **–ü–û–õ–ù–´–ô –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø** –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –æ–±—Ö–æ–¥ –≤—Å–µ—Ö –ø–æ–ª–∏—Ç–∏–∫ RLS (Row Level Security)
- ‚ö†Ô∏è –õ—é–±–æ–π –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
- ‚ö†Ô∏è –ö–ª—é—á–∏ —É–∂–µ –≤ git –∏—Å—Ç–æ—Ä–∏–∏ (–∫–æ–º–º–∏—Ç `616cbdb`), –≤–∏–¥–Ω—ã –≤—Å–µ–º

**–ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø:**

1. **–û—Ç–æ–∑–≤–∞—Ç—å –≤—Å–µ –∫–ª—é—á–∏:**
   - DeepSeek: https://platform.deepseek.com/api_keys
   - Supabase: https://supabase.com/dashboard/project/ygxnblhpjdhqjgcmcxgu/settings/api

2. **–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ Cloudflare Secrets:**
   ```bash
   # –£–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ wrangler.toml
   # –î–æ–±–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ Cloudflare CLI
   npx wrangler secret put DEEPSEEK_API_KEY
   npx wrangler secret put SUPABASE_SERVICE_ROLE_KEY
   ```

3. **–û—á–∏—Å—Ç–∏—Ç—å git –∏—Å—Ç–æ—Ä–∏—é** –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

---

### 2. üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

**–£—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–ü–∞–∫–µ—Ç:** Next.js 15.1.3

#### 2.1 CVE: Remote Code Execution (RCE)
- **CVSS Score:** 10.0 (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π)
- **CVE ID:** GHSA-9qr9-h5gf-34mp
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ React Flight Protocol
- **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –≤–µ—Ä—Å–∏–∏:** 15.1.0-canary.0 –¥–æ 15.1.9
- **–í–∞—à–∞ –≤–µ—Ä—Å–∏—è:** 15.1.3 ‚úó (—É—è–∑–≤–∏–º–∞)

#### 2.2 CVE: Authorization Bypass –≤ Middleware
- **CVSS Score:** 9.1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)
- **CVE ID:** GHSA-f82v-jwr5-mffw
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –û–±—Ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Next.js Middleware
- **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –≤–µ—Ä—Å–∏–∏:** 15.0.0 –¥–æ 15.2.3
- **–í–∞—à–∞ –≤–µ—Ä—Å–∏—è:** 15.1.3 ‚úó (—É—è–∑–≤–∏–º–∞)
- **–û—Å–æ–±–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:** –£ –≤–∞—Å –µ—Å—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å —Å middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π (`src/middleware.ts`)!

#### 2.3 –î—Ä—É–≥–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:
- **DoS —á–µ—Ä–µ–∑ Server Components** (CVSS 7.5) - GHSA-mwv6-3258-q52c
- **SSRF —á–µ—Ä–µ–∑ Middleware Redirect** (CVSS 6.5) - GHSA-4342-x723-ch2f
- **Cache Poisoning** (CVSS 7.5) - GHSA-67rr-84xm-4c7r

#### 2.4 –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ wrangler
- **esbuild** (CVSS 5.3) - moderate
- –¢—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ wrangler –¥–æ 4.54.0+

**–î–ï–ô–°–¢–í–ò–Ø:**
```bash
npm install next@latest      # –û–±–Ω–æ–≤–∏—Ç—å –¥–æ 15.2.3+
npm install wrangler@latest  # –û–±–Ω–æ–≤–∏—Ç—å –¥–æ 4.54.0+
npm audit fix
```

---

## ‚ö†Ô∏è –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

### 3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ Admin API Routes

**–£—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** üü† –í–´–°–û–ö–ò–ô
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/app/api/admin/**`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Middleware (`src/middleware.ts:88`) –∑–∞—â–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ UI —Ä–æ—É—Ç—ã: `/admin/:path*`
- API endpoints `/api/admin/*` –ù–ï –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ middleware
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ —Ä–æ—É—Ç–∞, –Ω–æ —ç—Ç–æ –Ω–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```typescript
// src/middleware.ts:87
export const config = {
  matcher: ['/admin/:path*']  // ‚Üê –¢–æ–ª—å–∫–æ UI, API –Ω–µ –∑–∞—â–∏—â–µ–Ω
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```typescript
export const config = {
  matcher: ['/admin/:path*', '/api/admin/:path*']  // ‚Üê –ó–∞—â–∏—Ç–∏—Ç—å –∏ API
}
```

**–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:**
- `src/app/api/admin/analytics/overview/route.ts` - –Ω–µ—Ç middleware –∑–∞—â–∏—Ç—ã
- `src/app/api/admin/analytics/ai/route.ts` - –Ω–µ—Ç middleware –∑–∞—â–∏—Ç—ã
- `src/app/api/admin/analytics/users/route.ts` - –Ω–µ—Ç middleware –∑–∞—â–∏—Ç—ã
- `src/app/api/admin/suggestions/route.ts` - –Ω–µ—Ç middleware –∑–∞—â–∏—Ç—ã

---

### 4. –£—è–∑–≤–∏–º–æ—Å—Ç—å Rate Limiting (in-memory)

**–£—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** üü† –í–´–°–û–ö–ò–ô
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/lib/rate-limit.ts:12`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
const rateLimitStore = new Map<string, RateLimitEntry>()
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**
- Rate limiting —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –≤—Å–µ –ª–∏–º–∏—Ç—ã —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
- –í Cloudflare Workers –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –∏–¥—Ç–∏ –Ω–∞ –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –æ–±–æ–π—Ç–∏ –ª–∏–º–∏—Ç—ã, –ø–µ—Ä–µ–∫–ª—é—á–∞—è—Å—å –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. **Cloudflare KV** - –ø—Ä–æ—Å—Ç–æ–µ key-value —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
2. **Cloudflare Durable Objects** - –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ rate limiting
3. **Upstash Redis** - —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è edge computing

---

### 5. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Security Headers

**–£—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** üü† –í–´–°–û–ö–ò–ô
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `next.config.js`

**–ü—Ä–æ–±–ª–µ–º–∞:**
–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

| –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|------------|--------|
| `Content-Security-Policy` | –ó–∞—â–∏—Ç–∞ –æ—Ç XSS –∞—Ç–∞–∫ | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| `X-Frame-Options` | –ó–∞—â–∏—Ç–∞ –æ—Ç clickjacking | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| `Strict-Transport-Security` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π HTTPS | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| `X-Content-Type-Options` | –ó–∞—â–∏—Ç–∞ –æ—Ç MIME sniffing | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| `Referrer-Policy` | –ö–æ–Ω—Ç—Ä–æ–ª—å referrer | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å –≤ `next.config.js`:
```javascript
const nextConfig = {
  output: 'standalone',
  async headers() {
    return [
      {
        source: '/:path*',
        headers: [
          {
            key: 'X-Frame-Options',
            value: 'DENY'
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff'
          },
          {
            key: 'Referrer-Policy',
            value: 'strict-origin-when-cross-origin'
          },
          {
            key: 'Strict-Transport-Security',
            value: 'max-age=31536000; includeSubDomains'
          },
          {
            key: 'Content-Security-Policy',
            value: [
              "default-src 'self'",
              "script-src 'self' 'unsafe-eval' 'unsafe-inline'",
              "style-src 'self' 'unsafe-inline'",
              "img-src 'self' data: https:",
              "font-src 'self' data:",
              "connect-src 'self' https://ygxnblhpjdhqjgcmcxgu.supabase.co https://api.deepseek.com"
            ].join('; ')
          }
        ]
      }
    ]
  },
  experimental: {
    serverActions: {
      bodySizeLimit: '2mb',
    },
  },
}
```

---

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û –ü–†–ê–í–ò–õ–¨–ù–û

### –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

1. ‚úÖ **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Supabase**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ industry-standard —Ä–µ—à–µ–Ω–∏—è
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

2. ‚úÖ **Row Level Security (RLS)**
   - –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `is_admin` RPC —Ñ—É–Ω–∫—Ü–∏—é

3. ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ API Routes**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `requireAuth()` –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

4. ‚úÖ **–ë–∞–∑–æ–≤—ã–π Rate Limiting**
   - –ó–∞—â–∏—Ç–∞ AI endpoints (20 req/min)
   - –•–æ—Ç—å –∏ in-memory, –Ω–æ –µ—Å—Ç—å

5. ‚úÖ **–ù–µ—Ç XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**
   - –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `dangerouslySetInnerHTML`
   - –ù–µ—Ç `eval()` –∏–ª–∏ `new Function()`
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞

6. ‚úÖ **SQL Injection –∑–∞—â–∏—Ç–∞**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Supabase ORM
   - –ù–µ—Ç –ø—Ä—è–º—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–æ–≤

7. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π .gitignore**
   - `.env` —Ñ–∞–π–ª—ã –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ git
   - –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∫—Ä–æ–º–µ wrangler.toml)

8. ‚úÖ **Input Validation**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ API routes
   - –í–∞–ª–∏–¥–∞—Ü–∏—è JSON –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç AI

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

### NPM Audit —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –£—Ä–æ–≤–µ–Ω—å     ‚îÇ –ö–æ–ª-–≤–æ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Critical    ‚îÇ   1  ‚îÇ
‚îÇ High        ‚îÇ   0  ‚îÇ
‚îÇ Moderate    ‚îÇ   2  ‚îÇ
‚îÇ Low         ‚îÇ   0  ‚îÇ
‚îÇ Total       ‚îÇ   3  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –ø–∞–∫–µ—Ç—ã:
- **next**: 1 critical, –≤–ª–∏—è–µ—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞–ø—Ä—è–º—É—é
- **wrangler**: 1 moderate (—á–µ—Ä–µ–∑ esbuild)
- **esbuild**: 1 moderate

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –ü–†–û–î–ê–ö–®–ï–ù–û–ú

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (–ë–õ–û–ö–ï–†–´ - –±–µ–∑ —ç—Ç–æ–≥–æ –ù–ï –¥–µ–ø–ª–æ–∏—Ç—å):
- [ ] –û—Ç–æ–∑–≤–∞—Ç—å –∏ —Å–º–µ–Ω–∏—Ç—å DEEPSEEK_API_KEY
- [ ] –û—Ç–æ–∑–≤–∞—Ç—å –∏ —Å–º–µ–Ω–∏—Ç—å SUPABASE_SERVICE_ROLE_KEY
- [ ] –£–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ wrangler.toml
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ Cloudflare Secrets
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Next.js –¥–æ 15.2.3+
- [ ] –û–±–Ω–æ–≤–∏—Ç—å wrangler –¥–æ 4.54.0+

### üü† –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Å–¥–µ–ª–∞—Ç—å –¥–æ –¥–µ–ø–ª–æ—è):
- [ ] –î–æ–±–∞–≤–∏—Ç—å `/api/admin/*` –≤ middleware matcher
- [ ] –î–æ–±–∞–≤–∏—Ç—å Security Headers –≤ next.config.js
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å in-memory rate limiting –Ω–∞ distributed (KV/Durable Objects)
- [ ] –û—á–∏—Å—Ç–∏—Ç—å git –∏—Å—Ç–æ—Ä–∏—é –æ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ (–∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ)

### üü° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (–º–æ–∂–Ω–æ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –¥–µ–ø–ª–æ—è):
- [ ] –î–æ–±–∞–≤–∏—Ç—å CSRF protection –¥–ª—è —Ñ–æ—Ä–º
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS headers –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry/Cloudflare Analytics)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- [ ] –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ backup –ë–î
- [ ] –î–æ–±–∞–≤–∏—Ç—å audit logging –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π

---

## üö¶ –§–ò–ù–ê–õ–¨–ù–´–ô –í–ï–†–î–ò–ö–¢

### ‚ùå –ö–û–î –ù–ï –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£
### ‚ùå –ö–û–î –ù–ï–õ–¨–ó–Ø –î–ï–õ–ê–¢–¨ –ü–£–ë–õ–ò–ß–ù–´–ú

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**

1. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π** - SUPABASE_SERVICE_ROLE_KEY –¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ë–î
2. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ CVE –≤ Next.js** - RCE (CVSS 10.0) –∏ Auth Bypass (CVSS 9.1)
3. **–£—è–∑–≤–∏–º—ã–π middleware** - admin API –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞—â–∏—â–µ–Ω—ã
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ security headers** - –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

**–û—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:** 40/100

**–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:** 2-4 —á–∞—Å–∞
**–í—Ä–µ–º—è –Ω–∞ –ø–æ–ª–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –≤ –ø–æ—Ä—è–¥–æ–∫:** 1-2 –¥–Ω—è

---

## üõ†Ô∏è –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô (–ü–æ—à–∞–≥–æ–≤—ã–π)

### –≠—Ç–∞–ø 1: –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –º–µ—Ä—ã (30 –º–∏–Ω—É—Ç)

```bash
# 1.1 –°–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã
# - –ó–∞–π—Ç–∏ –≤ DeepSeek Dashboard: https://platform.deepseek.com/api_keys
#   ‚Üí –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–ª—é—á ‚Üí –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π
# - –ó–∞–π—Ç–∏ –≤ Supabase Dashboard: https://supabase.com/dashboard/project/ygxnblhpjdhqjgcmcxgu/settings/api
#   ‚Üí Settings ‚Üí API ‚Üí Reset Service Role Key

# 1.2 –í—Ä–µ–º–µ–Ω–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–º (–µ—Å–ª–∏ –ø—É–±–ª–∏—á–Ω—ã–π)
# GitHub ‚Üí Settings ‚Üí Danger Zone ‚Üí Change visibility ‚Üí Make private
```

### –≠—Ç–∞–ø 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (10 –º–∏–Ω—É—Ç)

```bash
# 2.1 –û–±–Ω–æ–≤–∏—Ç—å Next.js –∏ wrangler
npm install next@latest wrangler@latest

# 2.2 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
npm audit fix

# 2.3 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
npm audit
```

### –≠—Ç–∞–ø 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ wrangler.toml (15 –º–∏–Ω—É—Ç)

```bash
# 3.1 –£–¥–∞–ª–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ —Ñ–∞–π–ª–∞
# –û—Ç–∫—Ä—ã—Ç—å wrangler.toml –∏ —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 15-18

# 3.2 –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã —á–µ—Ä–µ–∑ CLI
npx wrangler secret put DEEPSEEK_API_KEY
# –í–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π –∫–ª—é—á –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ

npx wrangler secret put SUPABASE_SERVICE_ROLE_KEY
# –í–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π –∫–ª—é—á –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ

# 3.3 –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
# –í wrangler.toml –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ:
# NEXT_PUBLIC_SUPABASE_URL
# NEXT_PUBLIC_SUPABASE_ANON_KEY
```

### –≠—Ç–∞–ø 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Security Headers (20 –º–∏–Ω—É—Ç)

```bash
# 4.1 –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å next.config.js
# –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é headers() –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ

# 4.2 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
npm run build
```

### –≠—Ç–∞–ø 5: –£—Å–∏–ª–µ–Ω–∏–µ middleware (10 –º–∏–Ω—É—Ç)

```bash
# 5.1 –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å src/middleware.ts
# –ò–∑–º–µ–Ω–∏—Ç—å matcher –Ω–∞:
# matcher: ['/admin/:path*', '/api/admin/:path*']

# 5.2 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
npm run dev
# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ /api/admin/analytics –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

### –≠—Ç–∞–ø 6: –û—á–∏—Å—Ç–∫–∞ git –∏—Å—Ç–æ—Ä–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 1 —á–∞—Å)

**–í–∞—Ä–∏–∞–Ω—Ç A: Filter-branch (—Å–ª–æ–∂–Ω–æ, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é)**
```bash
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch wrangler.toml" \
  --prune-empty --tag-name-filter cat -- --all

git push origin --force --all
```

**–í–∞—Ä–∏–∞–Ω—Ç B: –ù–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–ø—Ä–æ—â–µ, —Ç–µ—Ä—è–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è)**
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
# 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥ (–±–µ–∑ .git)
# 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π git
# 4. –ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç —É–∂–µ –±–µ–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤
```

### –≠—Ç–∞–ø 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ (15 –º–∏–Ω—É—Ç)

```bash
# 7.1 Audit –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
npm audit

# 7.2 –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ–∫—Ä–µ—Ç–æ–≤ –Ω–µ—Ç –≤ –∫–æ–¥–µ
grep -r "sk-5b24ee34458047a09ee8936c930bf625" .
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ

# 7.3 Build test
npm run build
npm run build:cloudflare

# 7.4 Deploy –Ω–∞ staging
npx wrangler deploy
```

---

## üìû –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:

1. **–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∞—É–¥–∏—Ç** - —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - Sentry, Cloudflare Analytics
3. **–°–æ–∑–¥–∞—Ç—å security policy** - SECURITY.md –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å dependabot** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
5. **Penetration testing** - –Ω–∞–Ω—è—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Next.js Security Best Practices](https://nextjs.org/docs/app/building-your-application/security)
- [Supabase Security](https://supabase.com/docs/guides/platform/security)
- [Cloudflare Workers Security](https://developers.cloudflare.com/workers/platform/security/)
- [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)

---

**–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω:** 2026-01-04
**–°–ª–µ–¥—É—é—â–∏–π –∞—É–¥–∏—Ç:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

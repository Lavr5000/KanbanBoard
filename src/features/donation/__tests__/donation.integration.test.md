# Интеграционные тесты для фичи Donation

## Проверка импортов и экспортов

### Test 1: Проверка экспорта из index.ts
**Цель**: Убедиться, что все необходимые компоненты и хуки экспортируются

**Проверка**:
```typescript
import {
  DonationButton,
  DonationModal,
  QRCodeDisplay,
  useDonationModal,
  PAYMENT_OPTIONS,
  DONATION_AMOUNTS
} from "@/features/donation";
```

**Ожидаемый результат**: Нет ошибок импорта

---

### Test 2: Проверка типов
**Цель**: Убедиться, что TypeScript корректно обрабатывает типы

**Проверка**:
```typescript
import type { PaymentMethod, PaymentOption } from "@/features/donation";

const method: PaymentMethod = "sbp"; // OK
const method2: PaymentMethod = "invalid"; // Error
```

**Ожидаемый результат**: TypeScript выдаёт ошибку для невалидных значений

---

## Проверка компонентов

### Test 3: DonationButton рендерится
**Цель**: Проверить базовый рендеринг кнопки

**Действия**:
1. Открыть приложение
2. Найти кнопку "Поддержать проект" в левой панели

**Ожидаемый результат**:
- Кнопка отображается
- Кнопка имеет розово-фиолетовый градиент
- Иконка сердца видна

---

### Test 4: Открытие модального окна
**Цель**: Проверить, что клик по кнопке открывает модальное окно

**Действия**:
1. Кликнуть на кнопку "Поддержать проект"
2. Дождаться открытия модального окна

**Ожидаемый результат**:
- Модальное окно появляется
- Фон затемняется
- Заголовок "Поддержать проект" виден

---

### Test 5: Закрытие модального окна
**Цель**: Проверить закрытие модального окна

**Действия**:
1. Открыть модальное окно
2. Кликнуть на кнопку "Закрыть"

**Ожидаемый результат**: Модальное окно закрывается

**Также проверить**:
- Клик на крестик (X) закрывает окно
- Состояние сбрасывается при закрытии

---

### Test 6: Выбор суммы
**Цель**: Проверить функциональность выбора суммы

**Действия**:
1. Открыть модальное окно
2. Кликнуть на кнопку "500 ₽"
3. Проверить выделение
4. Кликнуть на другую сумму

**Ожидаемый результат**:
- Выбранная сумма выделяется градиентом
- При выборе другой суммы предыдущее выделение снимается
- Внизу отображается выбранная сумма

---

### Test 7: Кастомная сумма
**Цель**: Проверить ввод кастомной суммы

**Действия**:
1. Открыть модальное окно
2. Ввести в поле "750"
3. Проверить, что предустановленные суммы не выделены
4. Проверить отображение суммы внизу

**Ожидаемый результат**:
- Кастомная сумма принимается
- Выделение с предустановленных сумм снимается
- Внизу показано "Сумма: 750 ₽"

---

### Test 8: Переключение способов оплаты
**Цель**: Проверить переключение между СБП, ЮMoney и Тинькофф

**Действия**:
1. Открыть модальное окно
2. По умолчанию должен быть выбран СБП
3. Кликнуть на ЮMoney
4. Кликнуть на Тинькофф

**Ожидаемый результат**:
- При каждом переключении:
  - Кнопка выделяется градиентом и рамкой
  - QR-код обновляется
  - Отображаются корректные реквизиты (телефон/счёт/карта)

---

### Test 9: QR-код отображение
**Цель**: Проверить загрузку и отображение QR-кода

**Действия**:
1. Открыть модальное окно
2. Дождаться загрузки QR-кода
3. Проверить для всех способов оплаты

**Ожидаемый результат**:
- QR-код загружается для каждого способа
- QR-код имеет белый фон
- При ошибке загрузки показывается fallback

---

### Test 10: Копирование реквизитов
**Цель**: Проверить функцию копирования

**Действия**:
1. Открыть модальное окно
2. Кликнуть на кнопку копирования рядом с телефоном (для СБП)
3. Проверить clipboard

**Ожидаемый результат**:
- Данные копируются в буфер обмена
- Иконка меняется на галочку
- Через 2 секунды иконка возвращается к Copy

---

## Проверка состояния (Zustand)

### Test 11: useDonationModal hook
**Цель**: Проверить работу Zustand store

**Действия**:
1. Импортировать `useDonationModal` в компоненте
2. Вызвать `open()`
3. Проверить `isOpen === true`
4. Вызвать `close()`
5. Проверить `isOpen === false`

**Ожидаемый результат**: Состояние корректно обновляется

---

## Проверка интеграции с Sidebar

### Test 12: Интеграция в Sidebar
**Цель**: Убедиться, что компонент корректно интегрирован

**Действия**:
1. Открыть приложение
2. Проверить порядок кнопок в левой панели

**Ожидаемый результат**:
Порядок кнопок сверху вниз:
1. "Поддержать проект" (яркая кнопка)
2. "Экспортировать данные"
3. "Предложения и жалобы"
4. "Выйти"

---

### Test 13: Независимость модальных окон
**Цель**: Проверить, что DonationModal и FeedbackModal не конфликтуют

**Действия**:
1. Открыть DonationModal
2. Закрыть
3. Открыть FeedbackModal
4. Закрыть
5. Открыть оба одновременно (через DevTools)

**Ожидаемый результат**:
- Оба модальных окна работают независимо
- Нет конфликтов z-index
- Нет ошибок в консоли

---

## Проверка адаптивности

### Test 14: Десктоп
**Действия**: Открыть на разрешении 1920x1080

**Ожидаемый результат**: Всё отображается корректно

---

### Test 15: Планшет
**Действия**: Открыть на разрешении 768x1024

**Ожидаемый результат**:
- Модальное окно адаптируется
- QR-код масштабируется

---

### Test 16: Мобильный
**Действия**: Открыть на разрешении 375x667

**Ожидаемый результат**:
- Модальное окно занимает большую часть экрана
- Кнопки остаются кликабельными
- QR-код видно полностью

---

## Проверка производительности

### Test 17: Нет лишних ре-рендеров
**Цель**: Убедиться в оптимизации

**Действия**:
1. Открыть React DevTools Profiler
2. Открыть модальное окно
3. Переключать способы оплаты
4. Проверить количество ре-рендеров

**Ожидаемый результат**: Минимальное количество ре-рендеров

---

### Test 18: Проверка памяти
**Цель**: Убедиться, что нет утечек памяти

**Действия**:
1. Открыть Chrome DevTools → Memory
2. Сделать snapshot
3. Открыть/закрыть модальное окно 20 раз
4. Сделать новый snapshot
5. Сравнить

**Ожидаемый результат**: Память очищается корректно

---

## Проверка безопасности

### Test 19: XSS защита
**Цель**: Убедиться, что нет уязвимостей XSS

**Действия**:
1. Попытаться ввести `<script>alert('XSS')</script>` в поле кастомной суммы
2. Проверить, что скрипт не выполняется

**Ожидаемый результат**: Скрипт не выполняется, текст экранируется

---

### Test 20: Проверка данных
**Цель**: Убедиться, что реквизиты обновлены

**Действия**:
1. Открыть `src/features/donation/model/types.ts`
2. Проверить, что номера телефонов/карт/счетов - реальные

**Ожидаемый результат**: Тестовые данные заменены на реальные

---

## Проверка билда

### Test 21: TypeScript компиляция
**Команда**: `npx tsc --noEmit`

**Ожидаемый результат**: Нет ошибок TypeScript

---

### Test 22: Next.js билд
**Команда**: `npm run build`

**Ожидаемый результат**:
- Билд проходит успешно
- Нет ошибок
- Нет предупреждений о неиспользуемых импортах

---

### Test 23: Линтер
**Команда**: `npm run lint`

**Ожидаемый результат**: Нет ошибок линтера

---

## Сводка

**Всего тестов**: 23

### Обязательные тесты (должны пройти все):
- Test 1-13, 21-23

### Рекомендуемые тесты:
- Test 14-20

### Критичные для пользователя:
- Test 3, 4, 5, 8, 9, 10

---

## Результаты тестирования

| # | Тест | Статус | Примечания |
|---|------|--------|------------|
| 1 | Импорты | ⏳ | |
| 2 | Типы | ⏳ | |
| 3 | Рендеринг кнопки | ⏳ | |
| 4 | Открытие модалки | ⏳ | |
| 5 | Закрытие модалки | ⏳ | |
| 6 | Выбор суммы | ⏳ | |
| 7 | Кастомная сумма | ⏳ | |
| 8 | Переключение способов | ⏳ | |
| 9 | QR-код | ⏳ | |
| 10 | Копирование | ⏳ | |
| 11 | Zustand hook | ⏳ | |
| 12 | Интеграция Sidebar | ⏳ | |
| 13 | Независимость модалок | ⏳ | |
| 14-16 | Адаптивность | ⏳ | |
| 17-18 | Производительность | ⏳ | |
| 19-20 | Безопасность | ⏳ | |
| 21 | TypeScript | ⏳ | |
| 22 | Build | ⏳ | |
| 23 | Lint | ⏳ | |

**Легенда**: ✅ Пройден | ❌ Не пройден | ⏳ Ожидает тестирования | ⚠️ Требует внимания
